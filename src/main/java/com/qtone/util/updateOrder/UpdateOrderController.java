package com.qtone.util.updateOrder;

import com.alibaba.fastjson.JSONObject;
import com.qtone.util.StringUtils;
import com.qtone.util.dao.test.TestUcMapper;
import com.qtone.util.updateOrder.dto.HandleOnlineV1Request;
import com.qtone.util.zxx.util.HttpUtils;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

import java.io.*;
import java.util.*;

/**
 * @Author: zhangpk
 * @Description:
 * @Date:Created in 13:55 2023/5/17
 * @Modified By:
 */
@Controller
@Slf4j
public class UpdateOrderController {

    @Autowired
    TestUcMapper testUcMapper;
    @Autowired
    HttpUtils httpUtils;

    @RequestMapping(value = "/update/order", method = RequestMethod.POST)
    @ResponseBody
    public void updateOrder() {
        List<String> fileUrls = new ArrayList<>();
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030823-result.txt");
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030933-result.txt");
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030934-result.txt");
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030952-result.txt");
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030963-result.txt");
        fileUrls.add("D:\\Deskop\\智学互动\\阿里云待处理订单\\result\\10030988-result.txt");

        Map<String,HandleOnlineV1Request> map = new HashMap<>();
        for(String fileUrl:fileUrls) {
            List<String> fileString = fileToData(fileUrl);
            for (String orderStr : fileString) {
                String[] arr = orderStr.split("请求参数:");
                List<HandleOnlineV1Request> orders = JSONObject.parseArray(arr[1], HandleOnlineV1Request.class);
                for(HandleOnlineV1Request order:orders) {
                    if (!map.containsKey(order.getGTID())){
                        map.put(order.getGTID(),order);
                    }
                }
            }
        }
        String url = "http://api.xuechengcloud.com/ecard/api/machine/offlineTransaction/v1";
        List<String> insertFailGtid = new ArrayList<>();
        List<String> postFailGtid = new ArrayList<>();
        for (HandleOnlineV1Request order : map.values()) {
            String gtid = testUcMapper.getOrderGtid(order.getGTID());
            if(StringUtils.isNotEmpty(gtid)){
                continue;
            }
            List<HandleOnlineV1Request> param = new ArrayList<>();
            param.add(order);
            String paramString = JSONObject.toJSONString(param);
            try {
                Map<String, Object> returnMap = httpUtils.postHttpMethod(url, paramString, null);
                log.info("gtid:"+order.getGTID()+","+ returnMap);
                if (StringUtils.isNotNullToObj(returnMap)) {
                    Integer code = StringUtils.objToInt(returnMap.get("code"));
                    if(code==200) {
                        try {
                            testUcMapper.insertOrderRequest(order.getGTID(),paramString);
                        } catch (Exception e) {
                            insertFailGtid.add(order.getGTID());
                        }
                    }else {
                        postFailGtid.add(gtid);
                    }
                }
            } catch (Exception e) {
                postFailGtid.add(gtid);
                e.printStackTrace();
            }
        }
        System.out.println("插入数据库失败："+insertFailGtid.toString());
        System.out.println("调用接口失败："+postFailGtid.toString());

    }

    public static void main(String[] args) {
        String fileUrl = "D:\\Deskop\\智学互动\\阿里云待处理订单\\10030933-result.txt";
        String str = "GZAT421F1600730SGZN09300003215520231009074419,GZAT421F1600688SGZN08880036577720231009074404,GZAT421F1600688SGZN08880036577620231009074345,GZAT421F1600730SGZN09300003215420231009073637,GZAT421F1600730SGZN09300003215320231009073617,GZAT421F1600730SGZN09300003215220231009073224,GZAT421F1600730SGZN09300003215120231009073206,GZAT421F1600730SGZN09300003215020231009072751,GZAT421F1600730SGZN09300003214920231009071814,GZAT421F1600730SGZN09300003214820231009071557,GZAT421F1600688SGZN08880036577520231009071426,GZAT421F1600797SGZN09970012402320231009071351,GZAT421F1600688SGZN08880036577420231009070150,GZAT421F1600688SGZN08880036577320231009065905,GZAT421F1600797SGZN09970012402220231009065903,GZAT421F1600688SGZN08880036577220231009065749,GZAT421F1600688SGZN08880036577120231009065507,GZAT421F1600688SGZN08880036577020231009065339,GZAT421F1600688SGZN08880036576920231009065224,GZAT421F1600730SGZN09300003214720231009065220,GZAT421F1600688SGZN08880036576820231009065105,GZAT421F1600688SGZN08880036576720231009065050,GZAT421F1600688SGZN08880036576620231009065041,GZAT421F1600688SGZN08880036576520231009065034,GZAT421F1600688SGZN08880036576420231009065025,GZAT421F1600688SGZN08880036576320231009064943,GZAT421F1600688SGZN08880036576220231009064916,GZAT421F1600688SGZN08880036576120231009064847,GZAT421F1600730SGZN09300003214620231009064727,GZAT421F1600688SGZN08880036576020231009064719,GZAT421F1600797SGZN09970012402120231009064713,GZAT421F1600688SGZN08880036575920231009064605,GZAT421F1600688SGZN08880036575820231009064557,GZAT421F1600745SGZN09450009705320231009064551,GZAT421F1600688SGZN08880036575720231009064532,GZAT421F1600688SGZN08880036575620231009064520,GZAT421F1600745SGZN09450009705220231009064519,GZAT421F1600688SGZN08880036575520231009064506,GZAT421F1600709SGZN09090003169520231009064500,GZAT421F1600688SGZN08880036575420231009064453,GZAT421F1600745SGZN09450009705120231009064441,GZAT421F1600709SGZN09090003169420231009064435,GZAT421F1600537SGZN07370005706420231009064420,GZAT421F1600709SGZN09090003169320231009064419,GZAT421F1600745SGZN09450009705020231009064417,GZAT421F1600537SGZN07370005706320231009064407,GZAT421F1600537SGZN07370005706220231009064356,GZAT421F1600709SGZN09090003169220231009064356,GZAT421F1600745SGZN09450009704920231009064349,GZAT421F1600537SGZN07370005706120231009064332,GZAT421F1600797SGZN09970012402020231009064332,GZAT421F1600745SGZN09450009704820231009064329,GZAT421F1600688SGZN08880036574320231009064326,GZAT421F1600537SGZN07370005706020231009064321,GZAT421F1600616SGZN08160007357920231009064319,GZAT421F1600688SGZN08880036574220231009064316,GZAT421F1600797SGZN09970012401920231009064315,GZAT421F1600745SGZN09450009704720231009064311,GZAT421F1600688SGZN08880036574120231009064309,GZAT421F1600618SGZN08180012205620231009064308,GZAT421F1600616SGZN08160007357820231009064306,GZAT421F1600688SGZN08880036574020231009064301,GZAT421F1600537SGZN07370005705920231009064254,GZAT421F1600616SGZN08160007357720231009064254,GZAT421F1600688SGZN08880036573920231009064253,GZAT421F1600709SGZN09090003169120231009064253,GZAT421F1600745SGZN09450009704620231009064252,GZAT421F1600797SGZN09970012401820231009064252,GZAT421F1600618SGZN08180012205520231009064247,GZAT421F1600688SGZN08880036573820231009064243,GZAT421F1600616SGZN08160007357620231009064237,GZAT421F1600688SGZN08880036573720231009064237,GZAT421F1600797SGZN09970012401720231009064236,GZAT421F1600618SGZN08180012205420231009064235,GZAT421F1600688SGZN08880036573620231009064232,GZAT421F1600745SGZN09450009704520231009064230,GZAT421F1600688SGZN08880036573520231009064226,GZAT421F1600537SGZN07370005705820231009064225,GZAT421F1600688SGZN08880036573420231009064221,GZAT421F1600709SGZN09090003169020231009064221,GZAT421F1600618SGZN08180012205320231009064221,GZAT421F1600797SGZN09970012401620231009064216,GZAT421F1600616SGZN08160007357520231009064215,GZAT421F1600688SGZN08880036573320231009064213,GZAT421F1600745SGZN09450009704420231009064212,GZAT421F1600688SGZN08880036573220231009064206,GZAT421F1600797SGZN09970012401520231009064206,GZAT421F1600618SGZN08180012205220231009064200,GZAT421F1600688SGZN08880036573120231009064159,GZAT421F1600537SGZN07370005705720231009064158,GZAT421F1600688SGZN08880036573020231009064153,GZAT421F1600745SGZN09450009704320231009064151,GZAT421F1600616SGZN08160007357420231009064151,GZAT421F1600709SGZN09090003168920231009064151,GZAT421F1600797SGZN09970012401420231009064148,GZAT421F1600688SGZN08880036572920231009064147,GZAT421F1600688SGZN08880036572820231009064142,GZAT421F1600616SGZN08160007357320231009064142,GZAT421F1600709SGZN09090003168820231009064139,GZAT421F1600618SGZN08180012205120231009064138,GZAT421F1600537SGZN07370005705620231009064137,GZAT421F1600688SGZN08880036572720231009064137,GZAT421F1600688SGZN08880036572620231009064131,GZAT421F1600688SGZN08880036572520231009064125,GZAT421F1600616SGZN08160007357220231009064125,GZAT421F1600618SGZN08180012205020231009064125,GZAT421F1600709SGZN09090003168720231009064122,GZAT421F1600688SGZN08880036572420231009064115,GZAT421F1600797SGZN09970012401320231009064115,GZAT421F1600616SGZN08160007357120231009064112,GZAT421F1600745SGZN09450009704220231009064110,GZAT421F1600796SGZN09960004395620231009064109,GZAT421F1600688SGZN08880036572320231009064108,GZAT421F1600537SGZN07370005705520231009064106,GZAT421F1600709SGZN09090003168620231009064105,GZAT421F1600688SGZN08880036572220231009064102,GZAT421F1600616SGZN08160007357020231009064101,GZAT421F1600797SGZN09970012401220231009064101,GZAT421F1600618SGZN08180012204920231009064055,GZAT421F1600688SGZN08880036572120231009064054,GZAT421F1600537SGZN07370005705420231009064050,GZAT421F1600797SGZN09970012401120231009064050,GZAT421F1600688SGZN08880036572020231009064047,GZAT421F1600709SGZN09090003168520231009064040,GZAT421F1600688SGZN08880036571920231009064039,GZAT421F1600537SGZN07370005705320231009064037,GZAT421F1600688SGZN08880036571820231009064034,GZAT421F1600616SGZN08160007356920231009064033,GZAT421F1600618SGZN08180012204820231009064028,GZAT421F1600537SGZN07370005705220231009064027,GZAT421F1600745SGZN09450009704120231009064026,GZAT421F1600688SGZN08880036571720231009064024,GZAT421F1600616SGZN08160007356820231009064021,GZAT421F1600618SGZN08180012204720231009064020,GZAT421F1600797SGZN09970012401020231009064016,GZAT421F1600709SGZN09090003168420231009064009,GZAT421F1600618SGZN08180012204620231009064009,GZAT421F1600745SGZN09450009704020231009064007,GZAT421F1600616SGZN08160007356720231009064002,GZAT421F1600797SGZN09970012400920231009064002,GZAT421F1600618SGZN08180012204520231009064000,GZAT421F1600745SGZN09450009703920231009063956,GZAT421F1600616SGZN08160007356620231009063953,GZAT421F1600618SGZN08180012204420231009063950,GZAT421F1600537SGZN07370005705120231009063948,GZAT421F1600616SGZN08160007356520231009063941,GZAT421F1600616SGZN08160007356420231009063932,GZAT421F1600618SGZN08180012204320231009063930,GZAT421F1600709SGZN09090003168320231009063927,GZAT421F1600537SGZN07370005705020231009063922,GZAT421F1600745SGZN09450009703820231009063918,GZAT421F1600813SGZN10130010694720231009063918,GZAT421F1600797SGZN09970012400820231009063916,GZAT421F1600537SGZN07370005704920231009063912,GZAT421F1600709SGZN09090003168220231009063911,GZAT421F1600813SGZN10130010694620231009063901,GZAT421F1600797SGZN09970012400720231009063858,GZAT421F1600618SGZN08180012204220231009063858,GZAT421F1600797SGZN09970012400620231009063848,GZAT421F1600745SGZN09450009703720231009063847,GZAT421F1600618SGZN08180012204120231009063846,GZAT421F1600813SGZN10130010694520231009063845,GZAT421F1600616SGZN08160007356320231009063844,GZAT421F1600537SGZN07370005704820231009063840,GZAT421F1600745SGZN09450009703620231009063835,GZAT421F1600618SGZN08180012204020231009063835,GZAT421F1600616SGZN08160007356220231009063832,GZAT421F1600797SGZN09970012400520231009063831,GZAT421F1600813SGZN10130010694420231009063828,GZAT421F1600537SGZN07370005704720231009063821,GZAT421F1600616SGZN08160007356120231009063820,GZAT421F1600797SGZN09970012400420231009063817,GZAT421F1600618SGZN08180012203920231009063814,GZAT421F1600537SGZN07370005704620231009063810,GZAT421F1600813SGZN10130010694320231009063808,GZAT421F1600616SGZN08160007356020231009063807,GZAT421F1600618SGZN08180012203820231009063800,GZAT421F1600709SGZN09090003168120231009063758,GZAT421F1600745SGZN09450009703520231009063757,GZAT421F1600797SGZN09970012400320231009063753,GZAT421F1600616SGZN08160007355920231009063752,GZAT421F1600813SGZN10130010694220231009063751,GZAT421F1600537SGZN07370005704520231009063749,GZAT421F1600616SGZN08160007355820231009063744,GZAT421F1600796SGZN09960004395520231009063742,GZAT421F1600745SGZN09450009703420231009063741,GZAT421F1600797SGZN09970012400220231009063741,GZAT421F1600709SGZN09090003168020231009063741,GZAT421F1600618SGZN08180012203720231009063739,GZAT421F1600797SGZN09970012400120231009063734,GZAT421F1600537SGZN07370005704420231009063732,GZAT421F1600616SGZN08160007355720231009063731,GZAT421F1600709SGZN09090003167920231009063725,GZAT421F1600618SGZN08180012203620231009063724,GZAT421F1600745SGZN09450009703320231009063722,GZAT421F1600813SGZN10130010694120231009063722,GZAT421F1600797SGZN09970012400020231009063716,GZAT421F1600813SGZN10130010694020231009063710,GZAT421F1600618SGZN08180012203520231009063710,GZAT421F1600745SGZN09450009703220231009063705,GZAT421F1600618SGZN08180012203420231009063702,GZAT421F1600797SGZN09970012399920231009063658,GZAT421F1600709SGZN09090003167820231009063658,GZAT421F1600616SGZN08160007355620231009063656,GZAT421F1600618SGZN08180012203320231009063651,GZAT421F1600797SGZN09970012399820231009063648,GZAT421F1600537SGZN07370005704320231009063647,GZAT421F1600688SGZN08880036569320231009063645,GZAT421F1600616SGZN08160007355520231009063644,GZAT421F1600813SGZN10130010693920231009063643,GZAT421F1600709SGZN09090003167720231009063639,GZAT421F1600745SGZN09450009703120231009063638,GZAT421F1600688SGZN08880036569220231009063636,GZAT421F1600797SGZN09970012399720231009063636,GZAT421F1600537SGZN07370005704220231009063633,GZAT421F1600688SGZN08880036569120231009063628,GZAT421F1600616SGZN08160007355420231009063627,GZAT421F1600618SGZN08180012203220231009063627,GZAT421F1600797SGZN09970012399620231009063625,GZAT421F1600813SGZN10130010693820231009063624,GZAT421F1600618SGZN08180012203120231009063619,GZAT421F1600688SGZN08880036569020231009063615,GZAT421F1600618SGZN08180012203020231009063611,GZAT421F1600813SGZN10130010693720231009063610,GZAT421F1600537SGZN07370005704120231009063606,GZAT421F1600616SGZN08160007355320231009063606,GZAT421F1600797SGZN09970012399520231009063606,GZAT421F1600688SGZN08880036568920231009063604,GZAT421F1600618SGZN08180012202920231009063558,GZAT421F1600745SGZN09450009703020231009063557,GZAT421F1600688SGZN08880036568820231009063554,GZAT421F1600813SGZN10130010693620231009063551,GZAT421F1600688SGZN08880036568720231009063548,GZAT421F1600709SGZN09090003167620231009063548,GZAT421F1600537SGZN07370005704020231009063547,GZAT421F1600616SGZN08160007355220231009063546,GZAT421F1600618SGZN08180012202820231009063546,GZAT421F1600813SGZN10130010693520231009063541,GZAT421F1600618SGZN08180012202720231009063539,GZAT421F1600537SGZN07370005703920231009063536,GZAT421F1600797SGZN09970012399420231009063536,GZAT421F1600688SGZN08880036568620231009063535,GZAT421F1600709SGZN09090003167520231009063530,GZAT421F1600616SGZN08160007355120231009063529,GZAT421F1600745SGZN09450009702920231009063528,GZAT421F1600537SGZN07370005703820231009063528,GZAT421F1600813SGZN10130010693420231009063528,GZAT421F1600688SGZN08880036568520231009063527,GZAT421F1600618SGZN08180012202620231009063526,GZAT421F1600797SGZN09970012399320231009063524,GZAT421F1600616SGZN08160007355020231009063520,GZAT421F1600688SGZN08880036568420231009063519,GZAT421F1600709SGZN09090003167420231009063518,GZAT421F1600797SGZN09970012399220231009063511,GZAT421F1600537SGZN07370005703720231009063507,GZAT421F1600813SGZN10130010693320231009063504,GZAT421F1600616SGZN08160007354920231009063503,GZAT421F1600745SGZN09450009702820231009063502,GZAT421F1600797SGZN09970012399120231009063502,GZAT421F1600618SGZN08180012202520231009063500,GZAT421F1600688SGZN08880036568320231009063456,GZAT421F1600797SGZN09970012399020231009063453,GZAT421F1600537SGZN07370005703620231009063452,GZAT421F1600813SGZN10130010693220231009063448,GZAT421F1600709SGZN09090003167320231009063448,GZAT421F1600537SGZN07370005703520231009063447,GZAT421F1600618SGZN08180012202420231009063447,GZAT421F1600688SGZN08880036568220231009063445,GZAT421F1600797SGZN09970012398920231009063439,GZAT421F1600688SGZN08880036568120231009063438,GZAT421F1600618SGZN08180012202320231009063438,GZAT421F1600616SGZN08160007354820231009063435,GZAT421F1600813SGZN10130010693120231009063432,GZAT421F1600797SGZN09970012398820231009063432,GZAT421F1600745SGZN09450009702720231009063431,GZAT421F1600537SGZN07370005703420231009063430,GZAT421F1600688SGZN08880036568020231009063425,GZAT421F1600797SGZN09970012398720231009063420,GZAT421F1600537SGZN07370005703320231009063418,GZAT421F1600688SGZN08880036567920231009063418,GZAT421F1600813SGZN10130010693020231009063413,GZAT421F1600709SGZN09090003167220231009063413,GZAT421F1600688SGZN08880036567820231009063409,GZAT421F1600616SGZN08160007354720231009063409,GZAT421F1600618SGZN08180012202220231009063406,GZAT421F1600537SGZN07370005703220231009063404,GZAT421F1600688SGZN08880036567720231009063402,GZAT421F1600745SGZN09450009702620231009063359,GZAT421F1600797SGZN09970012398620231009063358,GZAT421F1600688SGZN08880036567620231009063356,GZAT421F1600709SGZN09090003167120231009063355,GZAT421F1600813SGZN10130010692920231009063351,GZAT421F1600537SGZN07370005703120231009063349,GZAT421F1600688SGZN08880036567520231009063349,GZAT421F1600797SGZN09970012398520231009063348,GZAT421F1600618SGZN08180012202120231009063346,GZAT421F1600616SGZN08160007354620231009063343,GZAT421F1600709SGZN09090003167020231009063343,GZAT421F1600745SGZN09450009702520231009063341,GZAT421F1600688SGZN08880036567420231009063337,GZAT421F1600797SGZN09970012398420231009063336,GZAT421F1600618SGZN08180012202020231009063335,GZAT421F1600688SGZN08880036567320231009063330,GZAT421F1600709SGZN09090003166920231009063330,GZAT421F1600537SGZN07370005703020231009063323,GZAT421F1600688SGZN08880036567220231009063323,GZAT421F1600797SGZN09970012398320231009063323,GZAT421F1600618SGZN08180012201920231009063322,GZAT421F1600813SGZN10130010692820231009063319,GZAT421F1600745SGZN09450009702420231009063314,GZAT421F1600797SGZN09970012398220231009063314,GZAT421F1600709SGZN09090003166820231009063313,GZAT421F1600618SGZN08180012201820231009063307,GZAT421F1600797SGZN09970012398120231009063305,GZAT421F1600618SGZN08180012201720231009063259,GZAT421F1600813SGZN10130010692720231009063256,GZAT421F1600797SGZN09970012398020231009063254,GZAT421F1600537SGZN07370005702920231009063253,GZAT421F1600616SGZN08160007354520231009063250,GZAT421F1600618SGZN08180012201620231009063250,GZAT421F1600813SGZN10130010692620231009063243,GZAT421F1600745SGZN09450009702320231009063241,GZAT421F1600537SGZN07370005702820231009063240,GZAT421F1600797SGZN09970012397920231009063240,GZAT421F1600616SGZN08160007354420231009063238,GZAT421F1600618SGZN08180012201520231009063236,GZAT421F1600813SGZN10130010692520231009063235,GZAT421F1600730SGZN09300003214520231009063231,GZAT421F1600797SGZN09970012397820231009063225,GZAT421F1600618SGZN08180012201420231009063222,GZAT421F1600709SGZN09090003166720231009063218,GZAT421F1600537SGZN07370005702720231009063215,GZAT421F1600797SGZN09970012397720231009063211,GZAT421F1600618SGZN08180012201320231009063211,GZAT421F1600745SGZN09450009702220231009063204,GZAT421F1600618SGZN08180012201220231009063202,GZAT421F1600537SGZN07370005702620231009063200,GZAT421F1600813SGZN10130010692420231009063200,GZAT421F1600797SGZN09970012397620231009063159,GZAT421F1600618SGZN08180012201120231009063153,GZAT421F1600709SGZN09090003166620231009063151,GZAT421F1600745SGZN09450009702120231009063146,GZAT421F1600618SGZN08180012201020231009063145,GZAT421F1600797SGZN09970012397520231009063144,GZAT421F1600537SGZN07370005702520231009063143,GZAT421F1600813SGZN10130010692320231009063142,GZAT421F1600616SGZN08160007354320231009063139,GZAT421F1600537SGZN07370005702420231009063132,GZAT421F1600709SGZN09090003166520231009063132,GZAT421F1600745SGZN09450009702020231009063129,GZAT421F1600797SGZN09970012397420231009063129,GZAT421F1600618SGZN08180012200920231009063126,GZAT421F1600537SGZN07370005702320231009063122,GZAT421F1600813SGZN10130010692220231009063122,GZAT421F1600616SGZN08160007354220231009063118,GZAT421F1600618SGZN08180012200820231009063118,GZAT421F1600709SGZN09090003166420231009063115,GZAT421F1600745SGZN09450009701920231009063113,GZAT421F1600813SGZN10130010692120231009063111,GZAT421F1600537SGZN07370005702220231009063110,GZAT421F1600616SGZN08160007354120231009063104,GZAT421F1600618SGZN08180012200720231009063104,GZAT421F1600537SGZN07370005702120231009063058,GZAT421F1600797SGZN09970012397320231009063056,GZAT421F1600709SGZN09090003166320231009063056,GZAT421F1600745SGZN09450009701820231009063051,GZAT421F1600618SGZN08180012200620231009063051,GZAT421F1600813SGZN10130010692020231009063050,GZAT421F1600616SGZN08160007354020231009063041,GZAT421F1600537SGZN07370005702020231009063039,GZAT421F1600709SGZN09090003166220231009063039,GZAT421F1600618SGZN08180012200520231009063038,GZAT421F1600813SGZN10130010691920231009063036,GZAT421F1600745SGZN09450009701720231009063029,GZAT421F1600618SGZN08180012200420231009063027,GZAT421F1600797SGZN09970012397220231009063023,GZAT421F1600813SGZN10130010691820231009063022,GZAT421F1600709SGZN09090003166120231009063022,GZAT421F1600745SGZN09450009701620231009063021,GZAT421F1600537SGZN07370005701920231009063016,GZAT421F1600616SGZN08160007353920231009063016,GZAT421F1600618SGZN08180012200320231009063012,GZAT421F1600797SGZN09970012397120231009063010,GZAT421F1600709SGZN09090003166020231009063008,GZAT421F1600745SGZN09450009701520231009063008,GZAT421F1600813SGZN10130010691720231009063007,GZAT421F1600616SGZN08160007353820231009063004,GZAT421F1600618SGZN08180012200220231009063004,GZAT421F1600537SGZN07370005701820231009062957,GZAT421F1600797SGZN09970012397020231009062952,GZAT421F1600813SGZN10130010691620231009062951,GZAT421F1600618SGZN08180012200120231009062951,GZAT421F1600745SGZN09450009701420231009062941,GZAT421F1600797SGZN09970012396920231009062939,GZAT421F1600813SGZN10130010691520231009062938,GZAT421F1600709SGZN09090003165920231009062938,GZAT421F1600797SGZN09970012396820231009062931,GZAT421F1600618SGZN08180012200020231009062928,GZAT421F1600537SGZN07370005701720231009062925,GZAT421F1600616SGZN08160007353720231009062923,GZAT421F1600745SGZN09450009701320231009062923,GZAT421F1600797SGZN09970012396720231009062921,GZAT421F1600709SGZN09090003165820231009062920,GZAT421F1600618SGZN08180012199920231009062918,GZAT421F1600813SGZN10130010691420231009062914,GZAT421F1600537SGZN07370005701620231009062908,GZAT421F1600616SGZN08160007353620231009062908,GZAT421F1600618SGZN08180012199820231009062907,GZAT421F1600709SGZN09090003165720231009062906,GZAT421F1600745SGZN09450009701220231009062904,GZAT421F1600797SGZN09970012396620231009062902,GZAT421F1600537SGZN07370005701520231009062852,GZAT421F1600797SGZN09970012396520231009062852,GZAT421F1600709SGZN09090003165620231009062852,GZAT421F1600618SGZN08180012199720231009062849,GZAT421F1600813SGZN10130010691320231009062846,GZAT421F1600745SGZN09450009701120231009062845,GZAT421F1600616SGZN08160007353520231009062843,GZAT421F1600797SGZN09970012396420231009062842,GZAT421F1600618SGZN08180012199620231009062838,GZAT421F1600537SGZN07370005701420231009062830,GZAT421F1600616SGZN08160007353420231009062829,GZAT421F1600813SGZN10130010691220231009062827,GZAT421F1600618SGZN08180012199520231009062824,GZAT421F1600745SGZN09450009701020231009062824,GZAT421F1600537SGZN07370005701320231009062819,GZAT421F1600616SGZN08160007353320231009062816,GZAT421F1600797SGZN09970012396320231009062816,GZAT421F1600709SGZN09090003165520231009062815,GZAT421F1600537SGZN07370005701220231009062813,GZAT421F1600813SGZN10130010691120231009062811,GZAT421F1600537SGZN07370005701120231009062805,GZAT421F1600797SGZN09970012396220231009062804,GZAT421F1600616SGZN08160007353220231009062803,GZAT421F1600745SGZN09450009700920231009062801,GZAT421F1600618SGZN08180012199420231009062758,GZAT421F1600797SGZN09970012396120231009062753,GZAT421F1600537SGZN07370005701020231009062749,GZAT421F1600813SGZN10130010691020231009062747,GZAT421F1600616SGZN08160007353120231009062747,GZAT421F1600709SGZN09090003165420231009062747,GZAT421F1600618SGZN08180012199320231009062744,GZAT421F1600797SGZN09970012396020231009062740,GZAT421F1600745SGZN09450009700820231009062737,GZAT421F1600537SGZN07370005700920231009062734,GZAT421F1600618SGZN08180012199220231009062734,GZAT421F1600813SGZN10130010690920231009062732,GZAT421F1600616SGZN08160007353020231009062725,GZAT421F1600537SGZN07370005700820231009062724,GZAT421F1600618SGZN08180012199120231009062723,GZAT421F1600709SGZN09090003165320231009062722,GZAT421F1600745SGZN09450009700720231009062720,GZAT421F1600618SGZN08180012199020231009062715,GZAT421F1600797SGZN09970012395920231009062713,GZAT421F1600537SGZN07370005700720231009062710,GZAT421F1600813SGZN10130010690820231009062706,GZAT421F1600797SGZN09970012395820231009062703,GZAT421F1600709SGZN09090003165220231009062702,GZAT421F1600618SGZN08180012198920231009062656,GZAT421F1600745SGZN09450009700620231009062656,GZAT421F1600537SGZN07370005700620231009062655,GZAT421F1600797SGZN09970012395720231009062649,GZAT421F1600709SGZN09090003165120231009062645,GZAT421F1600537SGZN07370005700520231009062645,GZAT421F1600813SGZN10130010690720231009062642,GZAT421F1600618SGZN08180012198820231009062637,GZAT421F1600616SGZN08160007352920231009062634,GZAT421F1600709SGZN09090003165020231009062633,GZAT421F1600745SGZN09450009700520231009062633,GZAT421F1600797SGZN09970012395620231009062632,GZAT421F1600537SGZN07370005700420231009062631,GZAT421F1600618SGZN08180012198720231009062627,GZAT421F1600813SGZN10130010690620231009062622,GZAT421F1600537SGZN07370005700320231009062622,GZAT421F1600797SGZN09970012395520231009062621,GZAT421F1600616SGZN08160007352820231009062616,GZAT421F1600618SGZN08180012198620231009062616,GZAT421F1600745SGZN09450009700420231009062616,GZAT421F1600797SGZN09970012395420231009062613,GZAT421F1600709SGZN09090003164920231009062613,GZAT421F1600537SGZN07370005700220231009062611,GZAT421F1600616SGZN08160007352720231009062605,GZAT421F1600797SGZN09970012395320231009062603,GZAT421F1600618SGZN08180012198520231009062601,GZAT421F1600537SGZN07370005700120231009062559,GZAT421F1600813SGZN10130010690520231009062558,GZAT421F1600797SGZN09970012395220231009062552,GZAT421F1600618SGZN08180012198420231009062552,GZAT421F1600745SGZN09450009700320231009062544,GZAT421F1600709SGZN09090003164820231009062543,GZAT421F1600537SGZN07370005700020231009062543,GZAT421F1600618SGZN08180012198320231009062533,GZAT421F1600797SGZN09970012395120231009062529,GZAT421F1600709SGZN09090003164720231009062528,GZAT421F1600745SGZN09450009700220231009062528,GZAT421F1600813SGZN10130010690420231009062527,GZAT421F1600618SGZN08180012198220231009062526,GZAT421F1600537SGZN07370005699920231009062526,GZAT421F1600797SGZN09970012395020231009062519,GZAT421F1600537SGZN07370005699820231009062519,GZAT421F1600616SGZN08160007352620231009062517,GZAT421F1600618SGZN08180012198120231009062514,GZAT421F1600709SGZN09090003164620231009062509,GZAT421F1600745SGZN09450009700120231009062505,GZAT421F1600797SGZN09970012394920231009062503,GZAT421F1600813SGZN10130010690320231009062502,GZAT421F1600618SGZN08180012198020231009062456,GZAT421F1600537SGZN07370005699720231009062456,GZAT421F1600616SGZN08160007352520231009062452,GZAT421F1600797SGZN09970012394820231009062450,GZAT421F1600745SGZN09450009700020231009062446,GZAT421F1600618SGZN08180012197920231009062444,GZAT421F1600537SGZN07370005699620231009062442,GZAT421F1600709SGZN09090003164520231009062441,GZAT421F1600813SGZN10130010690220231009062439,GZAT421F1600709SGZN09090003164420231009062432,GZAT421F1600618SGZN08180012197820231009062431,GZAT421F1600797SGZN09970012394720231009062430,GZAT421F1600745SGZN09450009699920231009062423,GZAT421F1600797SGZN09970012394620231009062422,GZAT421F1600537SGZN07370005699520231009062421,GZAT421F1600813SGZN10130010690120231009062420,GZAT421F1600616SGZN08160007352420231009062420,GZAT421F1600618SGZN08180012197720231009062417,GZAT421F1600797SGZN09970012394520231009062410,GZAT421F1600709SGZN09090003164320231009062410,GZAT421F1600618SGZN08180012197620231009062409,GZAT421F1600537SGZN07370005699420231009062408,GZAT421F1600745SGZN09450009699820231009062403,GZAT421F1600616SGZN08160007352320231009062359,GZAT421F1600537SGZN07370005699320231009062359,GZAT421F1600813SGZN10130010690020231009062357,GZAT421F1600618SGZN08180012197520231009062355,GZAT421F1600797SGZN09970012394420231009062353,GZAT421F1600618SGZN08180012197420231009062345,GZAT421F1600745SGZN09450009699720231009062344,GZAT421F1600813SGZN10130010689920231009062343,GZAT421F1600797SGZN09970012394320231009062343,GZAT421F1600616SGZN08160007352220231009062340,GZAT421F1600709SGZN09090003164220231009062340,GZAT421F1600537SGZN07370005699220231009062339,GZAT421F1600618SGZN08180012197320231009062335,GZAT421F1600813SGZN10130010689820231009062328,GZAT421F1600618SGZN08180012197220231009062324,GZAT421F1600537SGZN07370005699120231009062324,GZAT421F1600745SGZN09450009699620231009062320,GZAT421F1600797SGZN09970012394220231009062318,GZAT421F1600813SGZN10130010689720231009062316,GZAT421F1600618SGZN08180012197120231009062316,GZAT421F1600616SGZN08160007352120231009062312,GZAT421F1600618SGZN08180012197020231009062304,GZAT421F1600797SGZN09970012394120231009062303,GZAT421F1600537SGZN07370005699020231009062256,GZAT421F1600616SGZN08160007352020231009062255,GZAT421F1600813SGZN10130010689620231009062251,GZAT421F1600797SGZN09970012394020231009062250,GZAT421F1600618SGZN08180012196920231009062246,GZAT421F1600537SGZN07370005698920231009062246,GZAT421F1600616SGZN08160007351920231009062245,GZAT421F1600709SGZN09090003164120231009062245,GZAT421F1600813SGZN10130010689520231009062238,GZAT421F1600797SGZN09970012393920231009062237,GZAT421F1600618SGZN08180012196820231009062235,GZAT421F1600709SGZN09090003164020231009062235,GZAT421F1600537SGZN07370005698820231009062232,GZAT421F1600616SGZN08160007351820231009062227,GZAT421F1600618SGZN08180012196720231009062226,GZAT421F1600797SGZN09970012393820231009062225,GZAT421F1600537SGZN07370005698720231009062223,GZAT421F1600709SGZN09090003163920231009062220,GZAT421F1600618SGZN08180012196620231009062214,GZAT421F1600813SGZN10130010689420231009062212,GZAT421F1600616SGZN08160007351720231009062209,GZAT421F1600709SGZN09090003163820231009062205,GZAT421F1600618SGZN08180012196520231009062204,GZAT421F1600537SGZN07370005698620231009062204,GZAT421F1600813SGZN10130010689320231009062158,GZAT421F1600616SGZN08160007351620231009062156,GZAT421F1600709SGZN09090003163720231009062155,GZAT421F1600618SGZN08180012196420231009062152,GZAT421F1600813SGZN10130010689220231009062143,GZAT421F1600618SGZN08180012196320231009062136,GZAT421F1600797SGZN09970012393720231009062132,GZAT421F1600537SGZN07370005698520231009062130,GZAT421F1600709SGZN09090003163620231009062126,GZAT421F1600537SGZN07370005698420231009062122,GZAT421F1600618SGZN08180012196220231009062121,GZAT421F1600813SGZN10130010689120231009062118,GZAT421F1600616SGZN08160007351520231009062115,GZAT421F1600618SGZN08180012196120231009062113,GZAT421F1600537SGZN07370005698320231009062113,GZAT421F1600797SGZN09970012393620231009062110,GZAT421F1600813SGZN10130010689020231009062105,GZAT421F1600709SGZN09090003163520231009062102,GZAT421F1600618SGZN08180012196020231009062056,GZAT421F1600616SGZN08160007351420231009062052,GZAT421F1600537SGZN07370005698220231009062051,GZAT421F1600813SGZN10130010688920231009062050,GZAT421F1600797SGZN09970012393520231009062050,GZAT421F1600618SGZN08180012195920231009062045,GZAT421F1600616SGZN08160007351320231009062039,GZAT421F1600709SGZN09090003163420231009062038,GZAT421F1600618SGZN08180012195820231009062036,GZAT421F1600813SGZN10130010688820231009062034,GZAT421F1600797SGZN09970012393420231009062031,GZAT421F1600537SGZN07370005698120231009062028,GZAT421F1600618SGZN08180012195720231009062024,GZAT421F1600616SGZN08160007351220231009062022,GZAT421F1600537SGZN07370005698020231009062018,GZAT421F1600797SGZN09970012393320231009062017,GZAT421F1600618SGZN08180012195620231009062010,GZAT421F1600709SGZN09090003163320231009062009,GZAT421F1600616SGZN08160007351120231009062008,GZAT421F1600537SGZN07370005697920231009062006,GZAT421F1600813SGZN10130010688720231009062000,GZAT421F1600797SGZN09970012393220231009061957,GZAT421F1600709SGZN09090003163220231009061954,GZAT421F1600537SGZN07370005697820231009061954,GZAT421F1600616SGZN08160007351020231009061950,GZAT421F1600618SGZN08180012195520231009061948,GZAT421F1600537SGZN07370005697720231009061941,GZAT421F1600618SGZN08180012195420231009061940,GZAT421F1600797SGZN09970012393120231009061933,GZAT421F1600537SGZN07370005697620231009061933,GZAT421F1600709SGZN09090003163120231009061931,GZAT421F1600797SGZN09970012393020231009061924,GZAT421F1600813SGZN10130010688620231009061922,GZAT421F1600537SGZN07370005697520231009061921,GZAT421F1600618SGZN08180012195320231009061920,GZAT421F1600709SGZN09090003163020231009061914,GZAT421F1600797SGZN09970012392920231009061913,GZAT421F1600616SGZN08160007350920231009061910,GZAT421F1600618SGZN08180012195220231009061902,GZAT421F1600616SGZN08160007350820231009061901,GZAT421F1600537SGZN07370005697420231009061901,GZAT421F1600813SGZN10130010688520231009061859,GZAT421F1600709SGZN09090003162920231009061858,GZAT421F1600797SGZN09970012392820231009061857,GZAT421F1600537SGZN07370005697320231009061845,GZAT421F1600616SGZN08160007350720231009061843,GZAT421F1600618SGZN08180012195120231009061843,GZAT421F1600709SGZN09090003162820231009061837,GZAT421F1600797SGZN09970012392720231009061836,GZAT421F1600618SGZN08180012195020231009061836,GZAT421F1600537SGZN07370005697220231009061829,GZAT421F1600616SGZN08160007350620231009061828,GZAT421F1600813SGZN10130010688420231009061827,GZAT421F1600797SGZN09970012392620231009061822,GZAT421F1600618SGZN08180012194920231009061822,GZAT421F1600709SGZN09090003162720231009061819,GZAT421F1600537SGZN07370005697120231009061815,GZAT421F1600813SGZN10130010688320231009061810,GZAT421F1600618SGZN08180012194820231009061809,GZAT421F1600797SGZN09970012392520231009061808,GZAT421F1600709SGZN09090003162620231009061805,GZAT421F1600616SGZN08160007350520231009061803,GZAT421F1600537SGZN07370005697020231009061802,GZAT421F1600618SGZN08180012194720231009061758,GZAT421F1600813SGZN10130010688220231009061756,GZAT421F1600797SGZN09970012392420231009061751,GZAT421F1600537SGZN07370005696920231009061749,GZAT421F1600618SGZN08180012194620231009061747,GZAT421F1600616SGZN08160007350420231009061741,GZAT421F1600709SGZN09090003162520231009061740,GZAT421F1600813SGZN10130010688120231009061739,GZAT421F1600797SGZN09970012392320231009061735,GZAT421F1600537SGZN07370005696820231009061732,GZAT421F1600709SGZN09090003162420231009061728,GZAT421F1600813SGZN10130010688020231009061726,GZAT421F1600616SGZN08160007350320231009061725,GZAT421F1600797SGZN09970012392220231009061725,GZAT421F1600616SGZN08160007350220231009061718,GZAT421F1600618SGZN08180012194520231009061717,GZAT421F1600709SGZN09090003162320231009061716,GZAT421F1600537SGZN07370005696720231009061716,GZAT421F1600797SGZN09970012392120231009061715,GZAT421F1600537SGZN07370005696620231009061707,GZAT421F1600813SGZN10130010687920231009061704,GZAT421F1600797SGZN09970012392020231009061702,GZAT421F1600709SGZN09090003162220231009061702,GZAT421F1600616SGZN08160007350120231009061658,GZAT421F1600618SGZN08180012194420231009061656,GZAT421F1600537SGZN07370005696520231009061651,GZAT421F1600618SGZN08180012194320231009061649,GZAT421F1600813SGZN10130010687820231009061645,GZAT421F1600616SGZN08160007350020231009061643,GZAT421F1600709SGZN09090003162120231009061640,GZAT421F1600797SGZN09970012391920231009061639,GZAT421F1600618SGZN08180012194220231009061638,GZAT421F1600796SGZN09960004395420231009061638,GZAT421F1600537SGZN07370005696420231009061633,GZAT421F1600797SGZN09970012391820231009061628,GZAT421F1600616SGZN08160007349920231009061625,GZAT421F1600813SGZN10130010687720231009061617,GZAT421F1600797SGZN09970012391720231009061616,GZAT421F1600616SGZN08160007349820231009061614,GZAT421F1600537SGZN07370005696320231009061614,GZAT421F1600618SGZN08180012194120231009061613,GZAT421F1600709SGZN09090003162020231009061608,GZAT421F1600537SGZN07370005696220231009061604,GZAT421F1600797SGZN09970012391620231009061600,GZAT421F1600618SGZN08180012194020231009061600,GZAT421F1600797SGZN09970012391520231009061551,GZAT421F1600537SGZN07370005696120231009061551,GZAT421F1600813SGZN10130010687620231009061550,GZAT421F1600616SGZN08160007349720231009061549,GZAT421F1600618SGZN08180012193920231009061541,GZAT421F1600797SGZN09970012391420231009061538,GZAT421F1600618SGZN08180012193820231009061532,GZAT421F1600537SGZN07370005696020231009061531,GZAT421F1600797SGZN09970012391320231009061529,GZAT421F1600618SGZN08180012193720231009061515,GZAT421F1600813SGZN10130010687520231009061511,GZAT421F1600797SGZN09970012391220231009061511,GZAT421F1600537SGZN07370005695920231009061508,GZAT421F1600616SGZN08160007349620231009061502,GZAT421F1600616SGZN08160007349520231009061440,GZAT421F1600813SGZN10130010687420231009061435,GZAT421F1600537SGZN07370005695820231009061433,GZAT421F1600616SGZN08160007349420231009061422,GZAT421F1600645SGZN08450003119120231009061409,GZAT421F1600537SGZN07370005695720231009061409,GZAT421F1600616SGZN08160007349320231009061402,GZAT421F1600537SGZN07370005695620231009061349,GZAT421F1600616SGZN08160007349220231009061336,GZAT421F1600537SGZN07370005695520231009061328,GZAT421F1600537SGZN07370005695420231009061313,GZAT421F1600616SGZN08160007349120231009061311,GZAT421F1600537SGZN07370005695320231009061256,GZAT421F1600537SGZN07370005695220231009061223,GZAT421F1600537SGZN07370005695120231009061210,GZAT421F1600537SGZN07370005695020231009061141,GZAT421F1600537SGZN07370005694920231009061126,GZAT421F1600537SGZN07370005694820231009061113,GZAT421F1600616SGZN08160007349020231009061102,GZAT421F1600537SGZN07370005694720231009061055,GZAT421F1600537SGZN07370005694620231009061027,GZAT421F1600537SGZN07370005694520231009060959,GZAT421F1600537SGZN07370005694420231009060946,GZAT421F1600537SGZN07370005694320231009060934";
        String[] gtids = str.split(",");
        List<String> fileString = fileToData(fileUrl);

        Map<String, HandleOnlineV1Request> map = new HashMap<>();
        for (String orderStr : fileString) {
            String[] arr = orderStr.split("数据处理：==============");
            try {
//                System.out.println(arr[1]);
//                List<HandleOnlineV1Request> orders = JSONObject.parseArray(arr[1], HandleOnlineV1Request.class);
//                for(HandleOnlineV1Request order:orders) {
//                    if (!map.containsKey(order.getGTID())){
//                        map.put(order.getGTID(),order);
//                    }
//                }

                HandleOnlineV1Request orderInfo = JSONObject.parseObject(arr[1],HandleOnlineV1Request.class);
                map.put(orderInfo.getGTID(),orderInfo);
            } catch (Exception e) {
                e.printStackTrace();
                String info = arr[1];
                info = info.replaceFirst("\\[","");
                String[] infos = info.split(",\\{\"wxUserId\"");
                for(int i=0;i<infos.length-1;i++){
                    String order = infos[i];
                    if(i!=0){
                        order = "{\"wxUserId\""+order;
                    }
                    HandleOnlineV1Request orderInfo = JSONObject.parseObject(order,HandleOnlineV1Request.class);
                    map.put(orderInfo.getGTID(),orderInfo);
                }
            }
        }
        Set<String> keys = map.keySet();
        for(String gtid:gtids){
            if (!keys.contains(gtid)){
                System.out.println(gtid);
            }
        }

    }

    public static List<String> fileToData(String fileUrl) {
        List<String> list = new ArrayList<>();
        BufferedReader br = null;
        try {
            br = new BufferedReader(new InputStreamReader(new FileInputStream(new File(fileUrl)), "UTF-8"));//UTF-8
            String str = null;
            int i = 0;
            while ((str = br.readLine()) != null) {
                if (StringUtils.isNotBlank(str)) {
                    list.add(str);
                }
                i++;
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                br.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return list;
    }



}
